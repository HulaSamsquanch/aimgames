// ==UserScript==
// @name        Swearify 2.0
// @description Adds a number of enhancements to your experience on AIM Games.
// @namespace   samsquanchhunter14@gmail.com
// @include     http://aimgames.forummotion.com/*
// @include     https://aimgames.forummotion.com/*
// @require     https://cdn.rawgit.com/js-cookie/js-cookie/master/src/js.cookie.js
// @require     https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js
// @require     https://cdn.rawgit.com/HulaSamsquanch/aimgames/master/swearify/jquery.caret.1.02.min.js
// @require     https://cdn.rawgit.com/HulaSamsquanch/aimgames/master/swearify/textUtils.js
// @version     beta.3.6
// @icon        http://i.imgur.com/MnWNRBL.png
// @license     MIT License (Expat); opensource.org/licenses/MIT
// @homepage    https://github.com/HulaSamsquanch/aimgames
// @supportURL  https://github.com/HulaSamsquanch/aimgames/issues
// @grant       none
// ==/UserScript==
'use strict';(function(){function y(a){$("head").append($('<link rel="stylesheet" type="text/css" />').m("href",a))}function B(){$("#divsmilies").click(function(a){window.open("/post?categ=6&mode=smilies","chatbox_smilies","toolbar=no,menubar=no,personalbar=no,width=350,height=300,scrollbars=yes,resizable=yes,left="+(a.screenX-270)+",top="+(a.screenY-380))})}function C(){"1"==getCookie("post_condition")?(m=1,$("#text_edit").b("cssText","display:none;"),$("#html_edit").b("cssText","")):(m=0,$("#text_edit").b("cssText",""),$("#html_edit").b("cssText","display:none;"));$("#text_editor_cmd_switchmode").click(function(){0===m?(setCookie("post_condition","1",1),m=1,$("#text_edit").b("cssText","display:none;"),$("#html_edit").b("cssText","")):1==m&&(setCookie("post_condition","0",1),m=0,$("#text_edit").b("cssText",""),$("#html_edit").b("cssText","display:none;"))})}function n(a,c,b){$(b).click(function(){if(window.opener){var b=window.opener.l("#message"),d="",g="";$(b).o().start<$(b).a().length?(d=b.a().substr(0,$(b).o().start),g=b.a().substr($(b).o().start,$(b).a().length)):(d=b.a().substr(0,$(b).a().length),g="");b.a(d+c+g)}parent&&(b=parent.l("textarea")[1],console.log(b),d=parent.l("textarea")[1].value,console.log(d),g="",g=d.substr(0,d.length),b.value=g+w(a)+"")});$(b).C(function(a){a.preventDefault()})}function p(a,c){return'<a href="javascript:void(0)" class="emotes"><img title="'+a+'" src="'+c+'" alt="'+a+'" border="0"></a>'}function w(a){return'<img title="posted by swearify" src="'+a+'"></img>'}function h(){return void 0===$("textarea")[1]?0:1}function z(a){for(var c=["CB_random","CB_rainbow"],b=0;b<c.length;b++)if(a!==c[b]&&"1"===Cookies.get(c[b]))return window.alert("You can't do that! You already have "+c[b]+" selected!"),!1;return!0}function D(){var a=$("td")[1];$(a).b("background",'linear-gradient( rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8) ), url("http://daffeinatek.byethost32.com/lastfm/resources/lighthole.gif")');$(a).b("background-size","100%");$(a).h($('<label style="font-size: 13px; font-weight: 900;">Swear Search \u2122</label><input id="emoteSearchBox" style="margin: 15px;border-color: black;"><label id="emoticonNotif" style="font-size: 9px;color: red;display: block;margin-bottom: 15px;font-weight: 600;">search something, shitmongrel</label>'))}function E(){$.c(F,function(a,c){$('[name="categ"]').append($("<option>",{value:a}).text(c))})}function k(){var a=document,c=a.documentElement,a=a.getElementsByTagName("body")[0];return Math.floor((window.innerWidth||c.clientWidth||a.clientWidth)/130)-1}function G(){$.c(swears,function(a,c){var b=$("#message").a(),f=$("#message").a().toLowerCase(),d="",g=b.indexOf(x[0]),r=b.indexOf(x[1]),q=b.indexOf(x[2]),e=b.indexOf(t[1]),k=b.indexOf(t[2]),l=b.indexOf(t[3]),h=0;if(-1!=b.indexOf(t[0])||-1!=e||-1!=k||-1!=l)h=1;if(0<g||0<r||0<q)e=f.substr(0,-1!=g?g:-1!=r?r:q),0<=e.indexOf(c)&&(d=b.substr(e.indexOf(c),c.length).split("").join(A[h]));-1==g&&-1==q&&-1==r&&0<=f.indexOf(c)&&(d=b.substr(f.indexOf(c),c.length).split("").join(A[h]));$("#message").a(b.replace(new RegExp(c,"gi"),d))})}function H(){var a,c=$.extend({},emoticon_1,emoticon_2,emoticon_3);$.c(c,function(c,f){a=$("textarea")[h()].value;0<=a.g(new RegExp(f[0],"gi"))&&($("textarea")[h()].value=a.replace(new RegExp(f[0],"gi"),w(f[1])))});$.c(twitch_c,function(c,f){a=$("textarea")[h()].value;0<=a.g(new RegExp("\\b"+f+"\\b","g"))&&($("textarea")[h()].value=a.replace(new RegExp("\\b"+f+"\\b","g"),w(twitch_e[c])))})}function I(){var a,c=$.extend({},emoticon_1,emoticon_2,emoticon_3);$.c(c,function(c,f){0<=$("#message").a().g(new RegExp(f[0],"gi"))&&(a=$("#message").a().replace(new RegExp(f[0],"gi"),u[0]+f[1]+u[1]),$("#message").a(a))});$.c(twitch_c,function(c,f){0<=$("#message").a().g(new RegExp("\\b"+f+"\\b","g"))&&(a=$("#message").a().replace(new RegExp("\\b"+f+"\\b","g"),u[0]+twitch_e[c]+u[1]),$("#message").a(a))})}function J(){$.c(maymay,function(a,c){if(0<=$("textarea")[h()].value.g(new RegExp(c[0],"gi"))){var b=$("textarea")[h()].value.replace(new RegExp(c[0],"gi"),c[1]);$("textarea")[h()].value=b}})}function K(){$.c(maymay,function(a,c){if(0<=$("#message").a().g(new RegExp(c[0],"gi"))){var b=$("#message").a().replace(new RegExp(c[0],"gi"),c[1]);$("#message").a(b)}})}function L(){var a=$(".text-styles tr")[0];$(a).h($('<td id="hide_button" class="fontbutton"></td>'));a=$(a).find("td");$(a[0]).append($('<input name="hide" id="hide-button" class="format-message" type="checkbox"><label id="click_area_hide" title="Hide" style="cursor:pointer;"></label>'));$("#click_area_hide").click(function(){$(".hider").is(":visible")?($(".hider").w(),$("#click_area_hide").text("<"),Cookies.set("CB_hide","1")):($(".hider").show(),$("#click_area_hide").text(">"),Cookies.set("CB_hide","0"))})}function M(){var a=$(".text-styles tr")[0];$(a).h($('<td id="rainbow_button" class="fontbutton hider"></td>'));a=$(a).find("td");$(a[0]).append($('<input name="rainbow" id="format-rainbow" class="format-message" type="checkbox"><label id="click_area_rainbow" title="Rainbow" style="cursor:pointer;height: 100%;"><img class="swearIcons" src="http://i.imgur.com/F69UQGS.png"></label>'));var c=$("#format-rainbow");"1"===Cookies.get("CB_rainbow")?$(c).f("checked",!0):$(c).f("checked",!1);$("#click_area_rainbow").click(function(){z("CB_rainbow")&&($(c).f("checked")?($(c).f("checked",!1),$(c).b("cssText",""),Cookies.set("CB_rainbow","0")):($(c).f("checked",!0),$(c).b("cssText","background: #CCC none repeat scroll 0% 0%;box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.15) inset, 0px 1px 2px rgba(0, 0, 0, 0.05);"),Cookies.set("CB_rainbow","1")))})}function N(){var a=$(".text-styles tr")[0];$(a).h($('<td id="random_button" class="fontbutton hider"></td>'));a=$(a).find("td");$(a[0]).append($('<input name="random" id="format-random" class="format-message" type="checkbox"><label id="click_area_random" title="Random" style="cursor:pointer;height: 100%;"><img class="swearIcons" src="http://i.imgur.com/jHMOnyI.png"></label>'));var c=$("#format-random");"1"===Cookies.get("CB_random")?$(c).f("checked",!0):$(c).f("checked",!1);$("#click_area_random").click(function(){z("CB_random")&&($(c).f("checked")?($(c).f("checked",!1),$(c).b("cssText",""),Cookies.set("CB_random","0")):($(c).f("checked",!0),$(c).b("cssText","background: #CCC none repeat scroll 0% 0%;box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.15) inset, 0px 1px 2px rgba(0, 0, 0, 0.05);"),Cookies.set("CB_random","1")))})}function O(a){var c=$.extend({},emoticon_1,emoticon_2,emoticon_3),b=[];$("#emoticonNotif").text("");0<a.length?($.c(c,function(c,d){if(0<=d[0].g(new RegExp(a,"gi"))){if(104<=b.length)return $("#emoticonNotif").text("too many results, capped at 104"),!1;b.push({name:c,i:d[0],j:d[1]})}}),$.c(twitch_c,function(c,d){if(0<=d.g(new RegExp(a,"gi"))){if(104<=b.length)return $("#emoticonNotif").text("too many results, capped at 104"),!1;b.push({name:d,i:d,j:twitch_e[c]})}})):$("#emoticonNotif").text("search something, shitmongrel");return b}function P(a,c){var b;b=$("table")[2]?$("table")[2]:$("table")[0];$(b).empty();$(b).append($("<tbody></tbody>"));var f=$(b).find("tbody")[0],d=0,g=0;$.c(a,function(b,q){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(q.i,a[b].j)));n(a[b].j,q.i,e);d++;d>=c&&(d=0,g++)})}function l(a,c){var b;$("table")[2]?b=$("table")[2]:(b=$("table")[0],c=1);$(b).empty();$(b).append($("<tbody></tbody>"));var f=$(b).find("tbody")[0],d=0,g=0;1==a&&$.c(emoticon_1,function(a,b){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(b[0],b[1])));n(b[1],b[0],e);d++;d>=c&&(d=0,g++)});2==a&&$.c(emoticon_2,function(a,b){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(b[0],b[1])));n(b[1],b[0],e);d++;d>=c&&(d=0,g++)});3==a&&$.c(emoticon_3,function(a,b){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(b[0],b[1])));n(b[1],b[0],e);d++;d>=c&&(d=0,g++)});4==a&&$.c(twitch_c,function(a,b){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(b,twitch_e[a])));n(twitch_e[a]," "+b+" ",e);d++;d>=c&&(d=0,g++)});5==a&&$.c(maymay,function(a,b){$(f).append($("<tr></tr>"));var e=$(f).find("tr")[g];$(e).append("<td></td>");e=$(e).find("td")[d];$(e).append($(p(b[1],b[1])));n(b[1],b[0],e);d++;d>=c&&(d=0,g++)})}function Q(){html2canvas(document.body,{F:function(a){var c=a.toDataURL("image/png");$("<div></div>").s({D:!0,title:"View Screenshot",open:function(){$(this).B("<a target='_blank' href='"+c+"'>Click to Open</a>")},buttons:{A:function(){$(this).s("close")}},close:function(){$(this).s("destroy").remove()}})}})}function R(){$(".genmed").h('<span id="chatbox_screenshot"><a href="javascript:void(0)">Take Screenshot</a></span>&nbsp;|&nbsp;');$("#chatbox_screenshot").click(function(){Q()})}var m=0,u=["[img]","[/img]"],v=["[color=#789922]","[/color]"],F={1:"Swearify 1",2:"Swearify 2",3:"Swearify 3",4:"Twitch",5:"Memes",6:"Search"},t=["/exit","/away","/abs","[code]"],A=["[b][/b]","."],x=["http://","www.","https://"];String.prototype.g=function(a){a=this.substring(0).search(a);return 0<=a?a+0:a};jQuery(document).ready(function(){$.v("https://rawgit.com/HulaSamsquanch/aimgames/master/swearify/swearifyVar.js",function(){E();if("http://aimgames.forummotion.com/post?categ=1&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=1&mode=smilies_frame"===window.location.href)console.log("done"),l(1,k()),window.onresize=function(){l(1,k())};if("http://aimgames.forummotion.com/post?categ=2&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=2&mode=smilies_frame"===window.location.href)l(2,k()),window.onresize=function(){l(2,k())};if("http://aimgames.forummotion.com/post?categ=3&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=3&mode=smilies_frame"===window.location.href)l(3,k()),window.onresize=function(){l(3,k())};if("http://aimgames.forummotion.com/post?categ=4&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=4&mode=smilies_frame"===window.location.href)l(4,k()),window.onresize=function(){l(4,k())};if("http://aimgames.forummotion.com/post?categ=5&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=5&mode=smilies_frame"===window.location.href)l(5,k()),window.onresize=function(){l(5,k())};if("http://aimgames.forummotion.com/post?categ=6&mode=smilies"===window.location.href||"http://aimgames.forummotion.com/smilies.forum?categ=6&mode=smilies_frame"===window.location.href){D();var a;$("#emoteSearchBox").u("keyup",function(){a&&clearTimeout(a);var c=this.value;a=setTimeout(function(){P(O(c),k())},250)})}"http://aimgames.forummotion.com/chatbox/index.forum?page=front&"===window.location.href||"http://aimgames.forummotion.com/chatbox/index.forum"===window.location.href||"http://aimgames.forummotion.com/chatbox/index.forum?archives=1"===window.location.href||"http://aimgames.forummotion.com/chatbox/index.forum?archives"===window.location.href||"http://aimgames.forummotion.com/chatbox"===window.location.href||"http://aimgames.forummotion.com/"===window.location.href?(y("https://rawgit.com/HulaSamsquanch/aimgames/master/swearify/78-ltr.css"),y("https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css"),$('label:contains("Message")').b("cssText","font-size:10px;color:white; margin-right:8px; margin-left:5px;"),$('label:contains("Message")').text("MESSAGE:"),$("#submit_button").b("cssText","font-size: 9px;color: #000;padding-right: 2px;margin-left: 3px;"),$("#submit_button").a("SEND"),$("#chatbox_members").b("cssText","color:black;"),$("#chatbox").b("cssText","overflow-x: hidden; left:141px;"),$('[width="10"]').text(""),$('[width="10"]').m("width","0px"),$('[src="http://illiweb.com/fa/subsilver/wysiwyg/smilie.gif"]').m("src","http://i.imgur.com/47NbRiV.gif"),L(),M(),N(),"1"===Cookies.get("CB_hide")?($(".hider").w(),$("#click_area_hide").text("<")):($(".hider").show(),$("#click_area_hide").text(">")),$("#click_area_hide").b("cssText","cursor: pointer;width: 10px;background: rgb(85, 85, 85) none repeat scroll 0px 0px;color: rgb(170, 170, 170);font-size: 9px;border: 1px solid rgb(85, 85, 85);-moz-user-select: none;-webkit-user-select: none;height: 100%;line-height: 200%;"),$(".swearIcons").b("cssText","padding-top: 1px;"),B(),-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&$.v("http://daffeinatek.byethost32.com/swearify/html2canvas.js",function(){R()}),$("#message").u("keydown",function(a){if(13===a.which||45===a.which)G(),I(),K(),0===$("#message").a().indexOf(">")&&$("#message").a(v[0]+$("#message").a()+v[1]),"1"===Cookies.get("CB_rainbow")&&$("#message").a(rainbowText($("#message").a())),"1"===Cookies.get("CB_random")&&$("#message").a(randomText($("#message").a()))})):(-1!=window.location.href.indexOf("aimgames.forummotion.com/post")&&C(),$("textarea").u("keydown",function(a){if(13===a.which){H();a=$("textarea")[h()].value.split("\n");for(var b=0;b<a.length;b++)0===a[b].indexOf(">")&&(a[b]=v[0]+a[b]+v[1],$("textarea")[h()].value=a.join("<br>"));J()}}))})})})();