// ==UserScript==
// @name        Chameleon
// @description Customizable message coloring for the AIM Chatbox.
// @namespace   samsquanchhunter14@gmail.com
// @include     https://aimgames.forummotion.com/*
// @include     http://aimgames.forummotion.com/*
// @version     4.fine.6.1.frostbiting.1453002991.8
// @grant       none
// @icon        http://i.imgur.com/jCJgorp.gif
// @license     MIT License (Expat); opensource.org/licenses/MIT
// ==/UserScript==
'use strict';function d(a){return Object.keys(a).map(function(b){return a[b]})}function e(a){return String("0123456789ABCDEF".substr(a>>4&15,1))+"0123456789ABCDEF".substr(a&15,1)}function f(){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(g[h]);return a?{r:parseInt(a[1],16),b:parseInt(a[2],16),a:parseInt(a[3],16)}:null}function k(a){return a[0].toUpperCase()+a.slice(1)}function m(a,b,c,l,v,w,x,y,z){for(var u=[],n=0;n<z;++n)u[n]="#"+e(Math.sin(c*n+w)*b+a)+e(Math.sin(l*n+x)*b+a)+e(Math.sin(v*n+y)*b+a);return u}var g=[],p={w:m(128,127,.3,.3,.3,0,2,4,32),G:"#ff3300 #0033cc #00cc00 #ffcc00 #cc00cc #6600ff #00ffff".split(" "),B:["#ff0000","#ffffff","#0000ff"],I:"#ff3300 #0033cc #00cc00 #ffcc00 #cc00cc #6600ff #00ffff".split(" "),o:m(200,55,.3,.3,.3,0,2,4,32),h:m(128,127,.1,.2,.3,0,2,4,27),J:m(128,127,.3,.3,.46,1.8,1.8,3.18,22),H:m(128,127,.24,.36,.46,.9,1.99,2.89,106),F:m(128,127,.3,.34,.3,2.32,3.6,1.8,22),l:m(128,127,1,1,1,3.6,2.14,2.21,19),c:m(128,127,1,1,1,1.61,.43,2.81,19),A:m(128,127,0,.3,.3,2.62,2.23,1.8,38),i:m(128,127,.29,0,.3,1.73,2.01,3.6,43),v:m(128,127,.29,0,.3,3.6,2.01,3.6,43),D:m(128,127,.42,0,0,1.86,3.6,3.6,43),m:m(128,127,1,0,0,1.86,1.07,3.6,38),g:m(128,127,.73,0,0,2.7,3.03,1.09,32),C:m(128,127,0,0,.35,2.14,0,0,35),j:m(128,127,0,0,.42,1.73,1.86,1.68,15),f:m(128,127,.34,.43,.33,0,.52,3.6,103),u:m(128,127,.34,.28,0,3.09,.38,3.52,224),s:m(128,127,.85,.34,.16,3.43,2.01,3.03,336)};function q(a,b){var c="",c=new Date;c.setTime(c.getTime()+864E5);c="; expires="+c.toGMTString();document.cookie=a+"="+b+c+"; path=/"}function r(a){a=a+"=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var l=b[c];" "==l.charAt(0);)l=l.substring(1);if(0===l.indexOf(a))return l.substring(a.length,l.length)}return""}function t(a){var b=document.createElement("option");b.text=a;b.style.dir="rtl";b.style.paddingRight="4px";return b}var h=0;(function(){var a=document.createElement("td");a.id="Cha";a.style.paddingRight="5px";document.getElementById("chatbox_messenger_form").getElementsByTagName("tr")[0].insertBefore(a,document.getElementById("chatbox_messenger_form").getElementsByTagName("tr")[0].childNodes[0]);a=document.getElementById("Cha");label=document.createElement("label");label.id="labelCha";a.appendChild(label);select=document.createElement("select");select.id="selectCha";a.appendChild(select);a=document.getElementById("selectCha");a.addEventListener("change",function(){var a=[];g=[];h=0;var b=[],c;for(c in p)b.push(c);for(c=0;c<d(p).length;c++)this.value.toLowerCase()==b[c]&&(a=p[b[c]]);q("chameleon_color_style",this.value.toLowerCase());for(b=0;b<a.length;b++)g[b]=a[b];document.getElementById("labelCha").textContent=a.length;q("chameleon_counter",h);q("CB_color",g[h]);document.getElementById("scolor").value=g[h];document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+f().r+","+f().b+","+f().a+");";document.getElementById("message").style.color=g[h]},!1);var b=[],c;for(c in p)b.push(c);for(c=0;c<b.length;c++)a.appendChild(t(k(b[c])))})();""===r("chameleon_color_style")?q("chameleon_color_style",p.normal):document.getElementById("selectCha").value=k(r("chameleon_color_style"));for(var A=0;A<p[r("chameleon_color_style")].length;A++)g[A]=d(p[r("chameleon_color_style")])[A];document.getElementById("labelCha").style.cssText="font-size: 10px; color: white; margin-right: 8px; margin-left: 5px;";document.getElementById("labelCha").innerHTML=p[r("chameleon_color_style")].length;if(null!==document.getElementById("frame_chatbox")||null!==document.getElementById("message"))1>=window.location.pathname.length?(0===r("chameleon_counter")?q("CB_color",g[h]):h=r("chameleon_counter"),document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").addEventListener("keydown",function(a){13==(a.keyCode?a.keyCode:a.which)&&(h++,h==g.length&&(h=0))},!1),document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").addEventListener("keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&(q("chameleon_counter",h),q("CB_color",g[h]),document.getElementById("frame_chatbox").contentWindow.document.getElementById("scolor").value=g[h],document.getElementById("frame_chatbox").contentWindow.document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+f().r+","+f().b+","+f().a+");",document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").style.color=g[h])},!1)):(0===r("chameleon_counter")?q("CB_color",g[h]):h=r("chameleon_counter"),document.getElementById("message").addEventListener("keydown",function(a){13==(a.keyCode?a.keyCode:a.which)&&(h++,h==g.length&&(h=0))},!1),document.getElementById("message").addEventListener("keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&(q("chameleon_counter",h),q("CB_color",g[h]),document.getElementById("scolor").value=g[h],document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+f().r+","+f().b+","+f().a+");",document.getElementById("message").style.color=g[h])},!1));