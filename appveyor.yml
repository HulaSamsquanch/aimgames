# Appveyor doesn"t have JDK 8 by default in PATH so we must set it

build_script: 
 - cmd: SET PATH="C:\Program Files\Java\jdk1.8.0\bin"
 - build.bat

on_success:

environment:
  access_token:
   secure: G8waKkParfgirZh3PKxylzY7tRDL4expH+CRtNjsh3FpKrfnzPld2nYsn+FQtn07

# Note: AppVeyor checkout only the last commit and not the entire branch. So you may have to checkout the wanted branch: git checkout master
on_success:
 - git config --global credential.helper store
 - ps: Add-Content "$env:USERPROFILE\.git-credentials" "https://$($env:access_token):x-oauth-basic@github.com`n"
 - git config --global user.email "chrishansen@notarealem.ail"
 - git config --global user.name "Appveyor Automated Build"
 - cmd: For /f "tokens=2-4 delims=/ " %%a in ('date /t') do (set mydate=%%c-%%a-%%b)
 - cmd: For /f "tokens=1-2 delims=/:" %%a in ('time /t') do (set mytime=%%a%%b)
 - git checkout -b failsafe-appveyor-test
 - git add bin/*
 - git commit -m "Automated Appveyor build at %mydate%_%mytime%"
 - git push origin master
