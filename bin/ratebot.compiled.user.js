// ==UserScript==
// @name        Rate Bot
// @description Rating bot for BestEverAlbums.com
// @namespace   kaffeinition@gmail.com
// @include     http://www.besteveralbums.com/*
// @version     1.3
// @grant       none
// @icon        data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEC0lEQVRYw+3XW4iVVRQH8J8HZ9RUcryUN0xQMAgq0gpLghEfspSQMh8Us4sRQogX6CErFcQQL1GiGSpBCWVampZBmUWUSmlJmogWmqR4F9TRcY5n9/Cto9/oQdSkenC/zKz9rb322mv913+tw411dasLluLOkEdgJdqhJT7CmPjWF/0xEXNjr13ojwj52cJVOlCH7bgt5P54Hk/hSUzC7WiGQdiCJXg89J8L/f4h39s095KheAZn8C7WYV68pAXuQXf8jtbxkiKOoxY9MRCbw2YNjsT/5Yd2CP3dIW8vXMNLEgaEfs+Qb8UyPIGbw7FUIYKnY79FyK3KH16Ly6Yu4etESqQSdavYOpkmu2l2ilIi7aS+Dc0LrK/jbFk/kRo4t4TeC/kmv3+O0hgG4x3MjnvL2DAd1Xi5wMREGs7MUzycSHV0hsc4fpqNJzm9j35tmV2ivifT4szCIr+9zsgCfRJpLQ/t45UGdoWdtqiKe6vLKWge3nxV4lPYS9cdtCxSWpflbcIQSsv4+TCrf2D+qSy3H+7Kwq4HqwqsHsu6Ej9Fbr/txNQSg25iH46iIe49W45AVXhGlqTzodvC21F/HRo4mAv1/ruztEF1ItVnuJG3c5a7SnxWYvre7KGXr+1qRibSdwxoYMMOjrVhbJH+x9jelYGdmXSGYpHaatp3Yk041beK0fi4PTWx1/swrcLBXpUcqMEUGUAsYHMibWNbP8af4a8f+aPI3kTawagDvBUg/XMy7+UjtoCN6LacFfn9EsUzWRlXXOPKDuQrApMjNaNib17uzIH4OzO+vRry2CivKVfCbE0vpMu5HCAT6oOUmlxjbdddiQOFYLfaYMFGFYFVmBGkVIOTcWYCDmMYPgn9MiA7YQ7WXCm/V6F90OQlFREXN8V96B17d2BF0DS8EM62C/2VV9mUrno1Ai4WBx2Px9MytL8ZUZkWF3bC/tB/KfQXF67RgWPRVMprT8htolMeqtCU9ldqSk3/wWxwXYBbMQIN9CnxZelCOz2/SuyZyP0XA/cQR4bySx6466jdyqNh53LAbcyIJ7llFm+kzMtG004ivchwDAnOmIuqROrD2gBWDUZ34fv3mRR22oat1nFfvildCqy+LI+DjYCVSLVZf2gErET6gAcDkGQ63QYzJVVOQ6NJ5RJgRedyMbDOceRoFpFGwDrB6V4czE87OHoqK3FX4sB5YC2l0DoYrV22d6IMrCKzBtHxYkPLWd+DB/KM2JFChwDqwczpy67uQQ7LSszJN5Ivsg63CPPr2bSJnTlG3IZhx9m6IXv9+WlnGb/m7RR55Hoz4uWAVR1nbvw4+f/2gUpV8K/2gfxA8p/0gWt1oDzA9MPnuQFmUURnRozb+QFmXIU+cBL+BqwwuY0/o2EGAAAAAElFTkSuQmCC
var cssLabel="font-size: 9px;",album_page=!1,artist_page=!1,track_page=!1,chart_page=!1,track_num=0,album_num=0,rating=-1;function resetLabel(){document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("label")[0].innerHTML="rate everything";document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("label")[0].style.cssText=cssLabel}window.addEventListener("load",function(){var a=window.location.href,a=a.substr(a.lastIndexOf("?")+1,1);"a"===a?(album_page=!0,track_num=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length):"b"===a?(artist_page=!0,track_num=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length,album_num=document.getElementsByClassName("chart")[0].getElementsByClassName("user").length):"c"===a?(chart_page=!0,album_num=document.getElementsByClassName("chart")[0].getElementsByClassName("user").length):"t"===a&&(track_page=!0);var b=document.getElementsByClassName("objectinteractionpanel")[0].children[0].children,c=document.createElement("td"),d=document.createElement("label"),a=document.createElement("input"),e=document.createElement("input");a.setAttribute("type","button");a.setAttribute("value","Rate-Bot");e.setAttribute("id","rate-amount");e.setAttribute("type","text");e.setAttribute("value","100");e.setAttribute("maxlength","3");e.addEventListener("focus",function(){resetLabel()},!0);d.innerHTML="rate everything";b[0].appendChild(c);b=b[0].getElementsByTagName("td")[0];b.appendChild(d).style.cssText=cssLabel;b.appendChild(e).style.cssText="width:20px;font-size:10px;";b.appendChild(a).addEventListener("click",function(){rating=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("input")[0].value;100>=rating?(album_page&&album_page_rate(track_num),artist_page&&artist_page_rate(track_num,album_num),chart_page&&chart_page_rate(album_num),track_page&&track_page_rate()):(d.innerHTML="must be <= 100",d.style.cssText+="color:red;")})},!1);function album_page_rate(a){rate_album();rate_tracks(a)}function artist_page_rate(a,b){rate_albums(b);rate_tracks(a);rate_band()}function chart_page_rate(a){rate_albums(a);rate_chart()}function track_page_rate(){rate_track()}function rate_tracks(a){for(var b=0;b<a;b++){var c=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[b].getElementsByClassName("user")[0].getAttribute("id"),c=c.split("_")[2],d=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+c+"&o=track&r="+d,!0);request.onreadystatechange=updatePage;request.send(null)}}function rate_track(){var a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+a+"&o=track&r="+b,!0);request.onreadystatechange=updatePage;request.send(null)}function rate_albums(a){for(var b=0;b<a;b++){var c=document.getElementsByClassName("chart")[0].getElementsByClassName("user")[b].getAttribute("id"),c=c.split("_")[2],d=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+c+"&o=album&r="+d,!0);request.onreadystatechange=updatePage;request.send(null)}}function rate_album(){var a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+a+"&o=album&r="+b,!0);request.onreadystatechange=updatePage;request.send(null)}function rate_chart(){var a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+a+"&o=chart&r="+b,!0);request.onreadystatechange=updatePage;request.send(null)}function rate_band(){var a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=rating.toString();createRequest();request.open("GET","AJAXRate.php?oid="+a+"&o=band&r="+b,!0);request.onreadystatechange=updatePage;request.send(null)};