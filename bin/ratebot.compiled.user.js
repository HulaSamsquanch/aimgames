// ==UserScript==
// @name        Rate Bot
// @description Rating bot for BestEverAlbums.com
// @namespace   kaffeinition@gmail.com
// @include     http://www.besteveralbums.com/*
// @version     1.3
// @grant       none
// @icon        http://i.imgur.com/0ns9tKG.png
// ==/UserScript==
'use strict';var d=!1,e=!1,f=!1,g=!1,h=0,k=0,l=-1,m=window.location.href,m=m.substr(m.lastIndexOf("?")+1,1);"a"===m?(d=!0,h=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length):"b"===m?(e=!0,h=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length,k=document.getElementsByClassName("chart")[0].getElementsByClassName("user").length):"c"===m?(g=!0,k=document.getElementsByClassName("chart")[0].getElementsByClassName("user").length):"t"===m&&(f=!0);var p=document.getElementsByClassName("objectinteractionpanel")[0].children[0].children,q=document.createElement("td"),r=document.createElement("label"),t=document.createElement("input"),u=document.createElement("input");t.setAttribute("type","button");t.setAttribute("value","Rate-Bot");u.setAttribute("id","rate-amount");u.setAttribute("type","text");u.setAttribute("value","100");u.setAttribute("maxlength","3");u.addEventListener("focus",function(){document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("label")[0].innerHTML="rate everything";document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("label")[0].style.cssText="font-size: 9px;"},!0);r.innerHTML="rate everything";p[0].appendChild(q);var v=p[0].getElementsByTagName("td")[0];v.appendChild(r).style.cssText="font-size: 9px;";v.appendChild(u).style.cssText="width:20px;font-size:10px;";v.appendChild(t).addEventListener("click",function(){l=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("input")[0].value;if(100>=l){if(d){var a=h,b=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),b=b.split("_")[2],c=l.toString();createRequest();request.open("GET","AJAXRate.php?oid="+b+"&o=album&r="+c,!0);request.onreadystatechange=updatePage;request.send(null);w(a)}e&&(a=h,x(),w(a),a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=l.toString(),createRequest(),request.open("GET","AJAXRate.php?oid="+a+"&o=band&r="+b,!0),request.onreadystatechange=updatePage,request.send(null));g&&(x(),a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=l.toString(),createRequest(),request.open("GET","AJAXRate.php?oid="+a+"&o=chart&r="+b,!0),request.onreadystatechange=updatePage,request.send(null));f&&(a=document.getElementsByClassName("objectinteractionpanel")[0].getElementsByTagName("ul")[0].getAttribute("id"),a=a.split("_")[2],b=l.toString(),createRequest(),request.open("GET","AJAXRate.php?oid="+a+"&o=track&r="+b,!0),request.onreadystatechange=updatePage,request.send(null))}else r.innerHTML="must be <= 100",r.style.cssText+="color:red;"});function w(a){for(var b=0;b<a;b++){var c=document.getElementsByClassName("tracks")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[b].getElementsByClassName("user")[0].getAttribute("id"),c=c.split("_")[2],n=l.toString();createRequest();request.open("GET","AJAXRate.php?oid="+c+"&o=track&r="+n,!0);request.onreadystatechange=updatePage;request.send(null)}}function x(){for(var a=k,b=0;b<a;b++){var c=document.getElementsByClassName("chart")[0].getElementsByClassName("user")[b].getAttribute("id"),c=c.split("_")[2],n=l.toString();createRequest();request.open("GET","AJAXRate.php?oid="+c+"&o=album&r="+n,!0);request.onreadystatechange=updatePage;request.send(null)}};