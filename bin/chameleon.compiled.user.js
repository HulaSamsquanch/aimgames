// ==UserScript==
// @name        Chameleon
// @description Customizable message coloring for the AIM Chatbox.
// @namespace   samsquanchhunter14@gmail.com
// @include     https://aimgames.forummotion.com/*
// @include     http://aimgames.forummotion.com/*
// @version     4.fine.6.1.frostbiting.1453002991.8
// @grant       none
// @icon        http://i.imgur.com/jCJgorp.gif
// @license     MIT License (Expat); opensource.org/licenses/MIT
// ==/UserScript==
'use strict';function values(a){return Object.keys(a).map(function(b){return a[b]})}function ayyliumLanguage(a){return String("0123456789ABCDEF".substr(a>>4&15,1))+"0123456789ABCDEF".substr(a&15,1)}function strangeAyylium(a,b,d){return"#"+ayyliumLanguage(a)+ayyliumLanguage(b)+ayyliumLanguage(d)}function hexToRgb(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function capitalizeFirstLetter(a){return a[0].toUpperCase()+a.slice(1)}function createRainbow(a,b,d,c,g,h,k,l,m){for(var f=[],e=0;e<m;++e)f[e]=strangeAyylium(Math.sin(d*e+h)*b+a,Math.sin(c*e+k)*b+a,Math.sin(g*e+l)*b+a);return f}var color_array=[],color_hex={normal:createRainbow(128,127,.3,.3,.3,0,2,4,32),trippy:"#ff3300 #0033cc #00cc00 #ffcc00 #cc00cc #6600ff #00ffff".split(" "),patriotic:["#ff0000","#ffffff","#0000ff"],warm:"#ff3300 #0033cc #00cc00 #ffcc00 #cc00cc #6600ff #00ffff".split(" "),light:createRainbow(200,55,.3,.3,.3,0,2,4,32),different:createRainbow(128,127,.1,.2,.3,0,2,4,27),yellow:createRainbow(128,127,.3,.3,.46,1.8,1.8,3.18,22),vast:createRainbow(128,127,.24,.36,.46,.9,1.99,2.89,106),toxic:createRainbow(128,127,.3,.34,.3,2.32,3.6,1.8,22),isabelle:createRainbow(128,127,1,1,1,3.6,2.14,2.21,19),blazing:createRainbow(128,127,1,1,1,1.61,.43,2.81,19),pastel:createRainbow(128,127,0,.3,.3,2.62,2.23,1.8,38),fruity:createRainbow(128,127,.29,0,.3,1.73,2.01,3.6,43),minty:createRainbow(128,127,.29,0,.3,3.6,2.01,3.6,43),strobe:createRainbow(128,127,.42,0,0,1.86,3.6,3.6,43),lemon:createRainbow(128,127,1,0,0,1.86,1.07,3.6,38),cotton:createRainbow(128,127,.73,0,0,2.7,3.03,1.09,32),peaches:createRainbow(128,127,0,0,.35,2.14,0,0,35),honey:createRainbow(128,127,0,0,.42,1.73,1.86,1.68,15),bright:createRainbow(128,127,.34,.43,.33,0,.52,3.6,103),maxed:createRainbow(128,127,.34,.28,0,3.09,.38,3.52,224),m4x3d:createRainbow(128,127,.85,.34,.16,3.43,2.01,3.03,336)};function setCookie(a,b,d){var c="";d?(c=new Date,c.setTime(c.getTime()+864E5*d),c="; expires="+c.toGMTString()):c="";document.cookie=a+"="+b+c+"; path=/"}function getCookie(a){a+="=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var c=b[d];" "==c.charAt(0);)c=c.substring(1);if(0===c.indexOf(a))return c.substring(a.length,c.length)}return""}function returnOption(a){var b=document.createElement("option");b.text=a;b.style.dir="rtl";b.style.paddingRight="4px";return b}function createSelectBox(){var a=document.createElement("td");a.id="Cha";a.style.paddingRight="5px";document.getElementById("chatbox_messenger_form").getElementsByTagName("tr")[0].insertBefore(a,document.getElementById("chatbox_messenger_form").getElementsByTagName("tr")[0].childNodes[0]);a=document.getElementById("Cha");label=document.createElement("label");label.id="labelCha";a.appendChild(label);select=document.createElement("select");select.id="selectCha";a.appendChild(select);a=document.getElementById("selectCha");a.addEventListener("change",function(){whatdo(this)},!1);var b=[],d;for(d in color_hex)b.push(d);for(d=0;d<b.length;d++)a.appendChild(returnOption(capitalizeFirstLetter(b[d])))}var counter=0;function whatdo(a){var b=[];color_array=[];counter=0;var d=[],c;for(c in color_hex)d.push(c);for(c=0;c<values(color_hex).length;c++)a.value.toLowerCase()==d[c]&&(b=color_hex[d[c]]);setCookie("chameleon_color_style",a.value.toLowerCase(),1);for(a=0;a<b.length;a++)color_array[a]=b[a];document.getElementById("labelCha").textContent=b.length;setCookie("chameleon_counter",counter,1);setCookie("CB_color",color_array[counter],1);document.getElementById("scolor").value=color_array[counter];document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+hexToRgb(color_array[counter]).r+","+hexToRgb(color_array[counter]).g+","+hexToRgb(color_array[counter]).b+");";document.getElementById("message").style.color=color_array[counter]}createSelectBox();""===getCookie("chameleon_color_style")?setCookie("chameleon_color_style",color_hex.normal,1):document.getElementById("selectCha").value=capitalizeFirstLetter(getCookie("chameleon_color_style"));for(var all=0;all<color_hex[getCookie("chameleon_color_style")].length;all++)color_array[all]=values(color_hex[getCookie("chameleon_color_style")])[all];document.getElementById("labelCha").style.cssText="font-size: 10px; color: white; margin-right: 8px; margin-left: 5px;";document.getElementById("labelCha").innerHTML=color_hex[getCookie("chameleon_color_style")].length;if(null!==document.getElementById("frame_chatbox")||null!==document.getElementById("message"))1>=window.location.pathname.length?(0===getCookie("chameleon_counter")?setCookie("CB_color",color_array[counter],1):counter=getCookie("chameleon_counter"),document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").addEventListener("keydown",function(a){13==(a.keyCode?a.keyCode:a.which)&&(counter++,counter==color_array.length&&(counter=0))},!1),document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").addEventListener("keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&(setCookie("chameleon_counter",counter,1),setCookie("CB_color",color_array[counter],1),document.getElementById("frame_chatbox").contentWindow.document.getElementById("scolor").value=color_array[counter],document.getElementById("frame_chatbox").contentWindow.document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+hexToRgb(color_array[counter]).r+","+hexToRgb(color_array[counter]).g+","+hexToRgb(color_array[counter]).b+");",document.getElementById("frame_chatbox").contentWindow.document.getElementById("message").style.color=color_array[counter])},!1)):(0===getCookie("chameleon_counter")?setCookie("CB_color",color_array[counter],1):counter=getCookie("chameleon_counter"),document.getElementById("message").addEventListener("keydown",function(a){13==(a.keyCode?a.keyCode:a.which)&&(counter++,counter==color_array.length&&(counter=0))},!1),document.getElementById("message").addEventListener("keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&(setCookie("chameleon_counter",counter,1),setCookie("CB_color",color_array[counter],1),document.getElementById("scolor").value=color_array[counter],document.getElementById("divcolor-preview").style.cssText="background-color: rgb("+hexToRgb(color_array[counter]).r+","+hexToRgb(color_array[counter]).g+","+hexToRgb(color_array[counter]).b+");",document.getElementById("message").style.color=color_array[counter])},!1));