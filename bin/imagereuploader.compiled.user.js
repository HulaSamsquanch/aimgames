// ==UserScript==
// @name            Swearify - Image Reuploader
// @namespace       samsquanchhunter
// @description     Special utility to quickly prepare images for insertion into Swearify.
// @version         1.3
// @include         http://*
// @include         https://*
// @grant           none
// ==/UserScript==
var body=document.body;body.addEventListener("contextmenu",initMenu,!1);var menu=document.createElement("menu");menu.id="userscript-search-by-image";menu.type="context";var menuitem=document.createElement("menuitem");menuitem.label="Resize and Upload";menuitem.icon="data:image/png;base64,\r\niVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz\r\nAAAK6wAACusBgosNWgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAAEl\r\nSURBVDiNY/z//z8DJYCRkIKsthv/kRX9Z2BgmFalARdiIcaGKZXqcH5O+01U+ay2G3MYGBiSiXUm\r\nmofnsBDSjEUTMkiBe2Eq1JnZ7TcZBHhZGNythBl0lLkZODmYGX7++sdw/sZnhl3H3zF8+voHwwsY\r\nFkR5ijNICLMzTF31hOHnr38MHGxMDJlhMgwv3vxkWL7jJYpaJmzu0lTigWtmYGBg+PHrH8P0VU8Y\r\ntJV5MNRiNYCfmxmuGQZ+/PrHwMmOqRyrAX///WfgYEOV4mBjwjAUpwHHL31iyA6XgRvCwcbEkBUm\r\nw3DuxmcMtVgDkYONicHLVoTBSJOXgYONieHHz38Ml+98Ydh88DXDtx//CBtACmBiYGCYS4H+OYyU\r\n5kasgUgKAADN8WLFzlj9rgAAAABJRU5ErkJggg==";menu.appendChild(menuitem);body.appendChild(menu);document.querySelector("#userscript-search-by-image menuitem").addEventListener("click",uploadImage,!1);function initMenu(a){a=a.target;var b=document.querySelector("#userscript-search-by-image menuitem");"img"==a.localName?(body.setAttribute("contextmenu","userscript-search-by-image"),b.setAttribute("imageURL",a.src)):(body.removeAttribute("contextmenu"),b.removeAttribute("imageURL"))}function copyToClipboard(a){window.prompt("Direct Link",a)}function fileTypeLength(a){return a.length-a.lastIndexOf(".")}function uploadImage(a){a=a.target.getAttribute("imageURL");var b=new XMLHttpRequest;document.querySelector(".status");var c=new FormData;c.append("image",a);b.open("POST","https://api.imgur.com/3/image");b.setRequestHeader("Authorization","Client-ID d8b88dd7493540b");b.onreadystatechange=function(){if(200===b.status&&4===b.readyState){var a=JSON.parse(b.responseText).data.link,a=a.slice(0,a.length-fileTypeLength(a))+"s"+a.slice(a.length-fileTypeLength(a));copyToClipboard(a)}};b.send(c)};